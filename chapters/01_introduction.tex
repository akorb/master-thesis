% !TeX root = ../main.tex
% Add the above to each chapter to make compiling the PDF easier in some editors.

\chapter{Introduction}\label{chapter:introduction}

This chapter includes an explanation of the exact problem we are addressing, and why, a brief overview of our solution, and the attacks we are trying to fend off.

% nicht wissenschaftliche Teil, zero trust ist jetzt ein Ding, immer mehr embedded ohne TPM (z.B. Gartner Studien)

\section{Motivation}

% Which area this thesis is talking about (Zero Trust)

Modern trust relationships, such as Zero Trust \cite{isaca2021}, require trustworthy platforms, which can reliably report their system state.
In such models, trustworthiness can only be assumed after the platform configuration has been proved by all parties of the communication.

% Primer on remote attestation

This is solved by remote attestation. In the simplest case, there is a prover and a verifier, as depicted in \autoref{fig:ra_simple}. This requires the verifier to establish trust with software or hardware on the prover's machine that attests the remaining software running on the prover.

\input{elements/figure_remote_attestation_process.tex}

% TPMs become more important

For example, this can be done with a \ac{TPM} on the prover's side. They rise in their deployments and importance, e.g., in 2013 the President's Council of Advisors on Science and Technology encourages the adoption of TPMs \cite{usa}, and Microsoft publicized that they require a TPM module for Windows~11 in 2021 \cite{win11req}.
They provide remote attestation mechanisms of system states, and their applications are still expanding beyond their traditional use-cases. For example, they are used in anti-cheat software for games \cite{valorant}.

% Short intro why fTPMs were introduced (for weak devices, exactly our target platform)

A dedicated hardware TPM (dTPM) increases cost and hardware complexity - especially for embedded platforms.
Through \acp{TEE}, such as Arm TrustZone, a \ac{fTPM} can be used to provide similar security guarantees as a dTPM chip.

% Why establishing trust in an fTPM is harder than in a dTPM

For a dTPM, which consists of an independent hardware unit manufactured by a single manufacturer and is directly activated by power, it is sufficient to identify its manufacturer and understand his provided guarantees.
In contrast, an \ac{fTPM} runs atop other firmware components and is started later in the boot chain, making its security dependent on the underlying firmware stack.
As a result, the fTPM can only be trusted if the entire underlying firmware stack is also trusted, since the underlying firmware could modify, i.e., compromise, the fTPM component which is then not detected.

% What's the difficulty of establishing trust to an fTPM?

However, while a TPM-compliant component provides an infrastructure with which trust in it can be established remotely, i.e., an endorsement certificate, the underlying firmware stack is not represented by this.

% How it currently works for fTPMs

Currently, this is solved by the manufacturer providing not only the fTPM, but also the entire underlying firmware stack.
Consequently, by establishing trust to the manufacturer of the fTPM, one can implicitly trust the underlying firmware as well by assuming they also originate from this manufacturer.
This is possible since in the most general sense, one can derive from an endorsement certificate the endorser, i.e., manufacturer, and if the attester trusts the manufacturer and the guarantees he provides, trust is established to his provided components.

\input{elements/figure_current_state.tex}

This process is illustrated in figure \autoref{fig:current_state}. The provers' area shows its boot chain, the verifiers' area shows how it evaluates the trustworthiness against the provers' boot chain. The verifier trusts the entire firmware chain if he trusts the manufacturer of each individual component. Note how the verifier must assume that the manufacturer of the firmware components is the same as the manufacturer of the fTPM.


% Summary

In summary, with the current approach, the endorser, usually a CPU manufacturer, provides the firmware up to the fTPM and guarantees the firmware is not modifiable by untrusted parties. This enables to establish trust the other firmware components this manufacturer provided without knowing the firmware.

% Current limitations

This approach is limited, as with this mechanism, independent verifiers have to blindly trust the firmware manufacturer, which drastically limits trust relationships.
In contrast, an independently verifiable fTPM stack, rooted in a hardware root of trust, can be leveraged in a zero trust environment without requiring additional hardware or compromising on security.

\section{Goal}

The goal is to break the requirement of the underlying firmware and the fTPM to originate from the same manufacturer, by providing the exact firmware component identities to the verifier, such that it can decide for itself whether they are trustworthy without relying on the manufacturer.

% Short introduction to DICE

One mechanism enabling firmware attestation is the \ac{DICE}, focusing on resource-constrained devices. Although this mechanism shifts trust from the firmware provider to the hardware provider by allowing firmware attestation through a hardware root of trust, the exclusive use of this integrated solution is unsuitable for large dynamic systems, for example Linux based devices.
Nevertheless, the advantage is that the identity of each component of the firmware boot chain is represented.

% How we try to overcome these limitations

We propose a hybrid solution, combining the advantages of \ac{DICE} and \acp{fTPM}, yielding an independently verifiable certificate chain representing the boot chain up to and including the \ac{fTPM}.
This enables a verifier to establish trust in an \ac{fTPM} if the underlying firmware is benign as well and thus, providing a way to independently assess the properties of the \ac{fTPM}.
% The conceptual basis for this is to attest the software stack of the TPM itself, and thus providing a way to independently assess the properties of the fTPM.

%Current \ac{fTPM} implementations require additional security measures to not leak state between reboots and different software versions.
%The final concept should provide a comprehensive guideline to implement an fTPM, which accounts for such an environment and reflect any relevant information through remote attestation.

The research questions are:
\begin{itemize}
  \item What constitutes the identity of an fTPM? %(e.g., hash, configuration, boot chain)
  \item How to combine the DICE and TPM infrastructure? %(e.g., AliasCert $\cup$ EKcert)
  \item How to manage an fTPM's persistent data securely? %(e.g., flush data on update)
  \item How to enable privacy for the attestation mechanism?
\end{itemize}

% Prover and verifier can take both roles for mutual attestation

% Chaining the underlying firmware identities with the endorsement identity

\section{Threat Model}

% https://trustedfirmware-a.readthedocs.io/en/latest/threat_model/threat_model.html

% We only need to trust the isolation between the TEE and REE
% And we also need to inherintly trust our root of trust (SRTM) starting the measurements of the subsequent firmware components
% Just because authenticity including integrity is given for boot components, this doesn't mean they are free of software bugs. We do not assume that the firmware, e.g., Arm trusted firmware-a, is free of bugs. That is up to the verifier to decide.

The main threat is the modification of the binary of the fTPM before or during boot. For example, by exchanging the SD card storing the binary.
However, we assume that the fTPM cannot be modified by malicious parties after the boot process regardless of whether the fTPM is benign or compromised because we trust the TEE environment.
Out-of-scope are hardware attacks, side-channel attacks, control-flow attacks, and Denial of Service attacks.

% Attacker model: What an attacker can do (abilities) and cannot do (limits)
For the network, we assume the Dolev-Yao attacker model \cite{Dolev1983}. That is, we consider an attacker who has the ability to perform any active or passive attacks on the network. The attacker may also have control over parts or the entire network, e.g., all routers, switches, and connections. However, attackers are limited in that they cannot control the end systems. They also cannot break cryptographic primitives, e.g., encryption, signing, and hashing.

% - In-scope
%     - Modification of fTPM (at boot, not runtime) (Q: Only at boot-time because the OP-TEE is trusted and therefore, no (malicious) runtime modifications are expected, correct?)
%     - Exchange of SD card
% - Out-of-scope
%     - HW attacks
%     - Side-channel attacks
%     - Control-flow attacks
%     - DoS attacks


\section{Environment}

This work was created at the 'Fraunhofer-Institut für Angewandte und Integrierte Sicherheit AISEC' in Garching.
It is part of the 'Fraunhofer Society for the Promotion of Applied Research e.~V.', which is an organization distributed over Europe with main focus on applied research.
In the roughly 35 years of its existence, it rose to become the largest research institute in Europe with around 30,000 employees.

\section{Outline}

% Übersicht über die Kapitel, was der Inhalt der Kapitel ist (Outline, mit bisschen mehr Text)
